<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Image → Text (AI)</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- Tailwind CDN for rapid dev; switch to CLI for prod -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      /* Soft animated gradient background */
      .bg-anim {
        background: radial-gradient(1200px 600px at 0% 0%, #fce7f3 0, transparent 60%),
                    radial-gradient(1000px 500px at 100% 0%, #e0e7ff 0, transparent 60%),
                    radial-gradient(1000px 500px at 100% 100%, #ccfbf1 0, transparent 60%),
                    radial-gradient(1000px 500px at 0% 100%, #fde68a 0, transparent 60%);
      }
      .glass {
        backdrop-filter: blur(12px);
        background: rgba(255,255,255,0.7);
      }
      @media (prefers-reduced-motion: no-preference) {
        .tilt:hover { transform: translateY(-2px) scale(1.01); transition: transform .25s; }
      }
    </style>
  </head>
  <body class="min-h-screen text-gray-800 bg-anim">
    <header class="max-w-5xl mx-auto px-4 pt-10">
      <div class="flex items-center justify-between">
        <h1 class="text-2xl md:text-3xl font-extrabold tracking-tight">
          Image → Text <span class="text-gray-500 font-medium">by OpenAI</span>
        </h1>
        <a href="/health" class="text-sm text-gray-500 hover:text-gray-700 underline">Health</a>
      </div>
      <p class="mt-2 text-gray-600">
        Upload an image (PNG/JPG/WEBP, ≤50MB). We’ll classify it with a crisp label and short rationale.
      </p>
    </header>

    <main class="max-w-5xl mx-auto px-4 pb-16">
      <section class="mt-8">
        <div class="glass rounded-2xl shadow-xl p-6 md:p-8 tilt">
          <!-- Dropzone -->
          <div id="dropzone"
               class="border-2 border-dashed border-gray-300 rounded-xl p-6 md:p-10 bg-white/60 hover:bg-white transition cursor-pointer text-center">
            <div class="mx-auto max-w-md">
              <div class="flex items-center justify-center">
                <svg class="w-12 h-12" viewBox="0 0 24 24" fill="none">
                  <path d="M12 16V4m0 0 4 4m-4-4-4 4M4 16v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-2"
                        stroke="currentColor" stroke-width="1.5" stroke-linecap="round" />
                </svg>
              </div>
              <p class="mt-4 font-semibold">Drag & drop your image here</p>
              <p class="text-sm text-gray-600 mt-1">or click to browse — PNG, JPG/JPEG, WEBP (≤50MB)</p>
              <input id="file" type="file" accept="image/png,image/jpeg,image/webp" class="hidden" />
              <div class="mt-6">
                <button id="browseBtn"
                        class="inline-flex items-center gap-2 px-4 py-2 rounded-xl bg-gray-900 text-white text-sm font-medium hover:opacity-90">
                  Choose image
                </button>
              </div>
            </div>
          </div>

          <!-- Preview -->
          <div id="previewWrap" class="hidden mt-6">
            <div class="flex gap-4 flex-col md:flex-row">
              <img id="preview" alt="Selected image preview"
                   class="w-full md:w-80 aspect-square object-cover rounded-xl border shadow-md" />
              <div class="flex-1">
                <div class="flex items-center gap-2">
                  <span id="fileName" class="text-sm font-medium"></span>
                  <span id="fileSize" class="text-xs text-gray-500"></span>
                  <span id="fileType" class="text-xs text-gray-500"></span>
                </div>
                <div class="mt-4">
                  <button id="predictBtn"
                          class="inline-flex items-center gap-2 px-4 py-2 rounded-xl bg-blue-600 text-white text-sm font-semibold hover:opacity-90 disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg id="spinner" class="hidden animate-spin -ml-1 mr-1 h-4 w-4" viewBox="0 0 24 24">
                      <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" fill="none" opacity="0.25"></circle>
                      <path d="M4 12a8 8 0 0 1 8-8" stroke="currentColor" stroke-width="4" fill="none"></path>
                    </svg>
                    Predict
                  </button>
                  <button id="clearBtn"
                          class="ml-2 inline-flex items-center px-3 py-2 rounded-xl bg-gray-200 text-gray-800 text-sm font-medium hover:bg-gray-300">
                    Clear
                  </button>
                </div>

                <div id="status" class="mt-4 text-sm text-gray-600"></div>
              </div>
            </div>
          </div>

          <!-- Result -->
          <div id="resultWrap" class="hidden mt-8">
            <h2 class="text-lg font-bold">Result</h2>

            <div class="mt-3 grid grid-cols-1 md:grid-cols-3 gap-4">
              <div class="bg-white/80 rounded-xl border p-4">
                <div class="text-xs uppercase text-gray-500">Label</div>
                <div id="resLabel" class="mt-1 text-xl font-extrabold"></div>
              </div>

              <div class="bg-white/80 rounded-xl border p-4">
                <div class="text-xs uppercase text-gray-500">Confidence</div>
                <div class="mt-1 text-lg font-semibold">
                  <span id="resConf"></span>
                </div>
                <div class="w-full bg-gray-200 h-2 rounded-full mt-2">
                  <div id="confBar" class="h-2 rounded-full bg-blue-600" style="width:0%"></div>
                </div>
              </div>

              <div class="bg-white/80 rounded-xl border p-4">
                <div class="text-xs uppercase text-gray-500">Top Alternatives</div>
                <div id="resAlt" class="mt-2 flex flex-wrap gap-2"></div>
              </div>
            </div>

            <div class="bg-white/80 rounded-xl border p-4 mt-4">
              <div class="text-xs uppercase text-gray-500">Rationale</div>
              <p id="resWhy" class="mt-1 text-gray-800"></p>
            </div>

            <details class="mt-4">
              <summary class="cursor-pointer text-sm text-gray-600">Raw JSON</summary>
              <pre id="resRaw" class="mt-2 p-3 bg-white rounded-lg border overflow-auto text-xs"></pre>
            </details>
          </div>

          <!-- Errors -->
          <div id="errorWrap" class="hidden mt-6 bg-red-50 border border-red-200 text-red-800 rounded-xl p-4">
            <div class="font-semibold">Something went wrong</div>
            <div id="errorText" class="text-sm mt-1"></div>
          </div>
        </div>
      </section>
    </main>

    <footer class="max-w-5xl mx-auto px-4 pb-10 text-center text-xs text-gray-500">
      Built with FastAPI, Tailwind, and OpenAI. Keep it respectful & safe.
    </footer>

    <script src="/static/app.js"></script>
  </body>
</html>
